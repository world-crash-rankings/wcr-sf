{% extends 'base.html.twig' %}
{% import 'zone/_macros.html.twig' as macros %}

{% block title %}{{ player.name }} - {{ parent() }}{% endblock %}

{% block meta_description %}{{ player.name }} - Burnout 2 Crash Mode player profile. View personal records, rankings (AP: #{{ player.avgPosRank ?? 'N/A' }}, Total: #{{ player.totalRank ?? 'N/A' }}), and statistics across all zones.{% endblock %}

{% block meta_keywords %}{{ player.name }}, burnout 2 player, crash mode statistics, player rankings{% endblock %}

{% block og_type %}profile{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "{{ player.name }}",
  "nationality": {
    "@type": "Country",
    "name": "{{ player.country.name }}"
  },
  "url": "{{ url('player_view', {nameUrl: player.nameUrl}) }}"
}
</script>
{% endblock %}

{% block body %}
{% set active_tab = 'view' %}
{% include 'player/_header.html.twig' %}

{# Player stats cards #}
<div class="row">
    <div class="col-12">
        <div class="row g-3 mb-4">
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h6 class="card-subtitle mb-2 text-muted">Total Score</h6>
                        <h4 class="card-title mb-0">
                            {% if player.total %}
                                ${{ player.total|number_format(0, '.', ',') }}
                            {% else %}
                                -
                            {% endif %}
                        </h4>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h6 class="card-subtitle mb-2 text-muted">Average Position</h6>
                        <h4 class="card-title mb-0">
                            {% if player.avgPos %}
                                {{ player.avgPos }}
                            {% else %}
                                -
                            {% endif %}
                        </h4>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h6 class="card-subtitle mb-2 text-muted">Average Stars</h6>
                        <h4 class="card-title mb-0">
                            {% if player.avgStars %}
                                {{ player.avgStars }}
                            {% else %}
                                -
                            {% endif %}
                        </h4>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body text-center">
                        <h6 class="card-subtitle mb-2 text-muted">% WR</h6>
                        <h4 class="card-title mb-0">
                            {% if player.avgPercent %}
                                {{ player.avgPercent }}%
                            {% else %}
                                -
                            {% endif %}
                        </h4>
                    </div>
                </div>
            </div>
        </div>

        {# Personal Records Section #}
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h2 class="mb-0">Personal Records</h2>
            </div>
            <div class="card-body p-0">
                {% if personalRecords is empty %}
                    <p class="text-center text-muted p-4">No personal records found.</p>
                {% else %}
                    <table class="table table-striped table-hover mb-0">
                        <tbody>
                            {% for score in personalRecords %}
                                {{ macros.player_score_row(score.chartRank ?? '-', score, true) }}
                            {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
