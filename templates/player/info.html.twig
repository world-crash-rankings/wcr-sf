{% extends 'base.html.twig' %}

{% block title %}{{ player.name }} - Info - {{ parent() }}{% endblock %}

{% block meta_description %}Detailed statistics for {{ player.name }}: platform breakdown, car usage, proof types, and performance metrics in Burnout 2 Crash Mode.{% endblock %}

{% block meta_keywords %}{{ player.name }} statistics, player info, platform stats, car usage{% endblock %}

{% block og_type %}profile{% endblock %}

{% block body %}
{% set active_tab = 'info' %}
{% include 'player/_header.html.twig' %}

{# Player Notes #}
{% if player.notes %}
<div class="row mb-4">
    <div class="col-12 col-md-8 offset-md-2">
        <div class="card">
            <div class="card-body">
                <h4>{{ player.notes }}</h4>
            </div>
        </div>
    </div>
</div>
{% endif %}

{# Rankings Section #}
<div class="row mb-4">
    <div class="col-12 col-md-8 offset-md-2">
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h2 class="mb-0">Rankings</h2>
            </div>
            <div class="card-body p-0">
                <table class="table table-striped table-hover mb-0">
                    <tbody>
                        <tr class="text-center fs-4">
                            <td><a href="{{ path('rankings_ap') }}" class="text-decoration-none" title="Average Position">AP</a></td>
                            <td>{{ player.avgPos }}</td>
                            <td>#{{ player.avgPosRank }}</td>
                        </tr>
                        <tr class="text-center fs-4">
                            <td><a href="{{ path('rankings_total') }}" class="text-decoration-none">Total</a></td>
                            <td>${{ player.total|number_format(0, '.', ',') }}</td>
                            <td>#{{ player.totalRank }}</td>
                        </tr>
                        <tr class="text-center fs-4">
                            <td><a href="{{ path('rankings_percent') }}" class="text-decoration-none">% WR</a></td>
                            <td>{{ player.avgPercent }}%</td>
                            <td>#{{ player.avgPercentRank }}</td>
                        </tr>
                        <tr class="text-center fs-4">
                            <td><a href="{{ path('rankings_stars') }}" class="text-decoration-none">Rating</a></td>
                            <td title="{{ player.avgStars }}">
                                {% for i in 1..10 %}
                                    {% if i <= player.avgStars %}
                                        <img src="{{ asset('img/stars/full.png') }}" alt="★" width="20" height="20">
                                    {% else %}
                                        <img src="{{ asset('img/stars/empty.png') }}" alt="☆" width="20" height="20">
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>#{{ player.avgStarsRank }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{# Proofs Section #}
<div class="row mb-4">
    <div class="col-12 col-md-8 offset-md-2">
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h2 class="mb-0">Proofs</h2>
            </div>
            <div class="card-body p-0">
                <table class="table table-striped mb-0">
                    <tbody>
                        <tr class="text-center">
                            <td>
                                {{ proofs['Live'] }}
                                <img src="{{ asset('img/proofs/live.png') }}" alt="Live" title="Live" width="48" height="48" class="ms-2">
                            </td>
                            <td>
                                {{ proofs['Replay'] }}
                                <img src="{{ asset('img/proofs/replay.png') }}" alt="Replay" title="Replay" width="48" height="48" class="ms-2">
                            </td>
                            <td>
                                {{ proofs['XBL'] }}
                                <img src="{{ asset('img/proofs/xbl.png') }}" alt="XBL" title="XBL" width="48" height="48" class="ms-2">
                            </td>
                            <td>
                                {{ proofs['Pic'] }}
                                <img src="{{ asset('img/proofs/pic.png') }}" alt="Pic" title="Pic" width="48" height="48" class="ms-2">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{# Statistics Row #}
<div class="row mb-4">
    {# Podium Ranks #}
    <div class="col-12 col-md-3">
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h3 class="mb-0">Podium Ranks</h3>
            </div>
            <div class="card-body p-0">
                <table class="table table-striped mb-0">
                    <tbody>
                        {% for rank, nb in podiums %}
                            <tr class="text-center">
                                <td>
                                    <img src="{{ asset('img/medals/' ~ rank ~ '.png') }}" alt="Rank {{ rank }}" width="48" height="48">
                                </td>
                                <td class="fs-5">{{ nb }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    {# Platforms #}
    <div class="col-12 col-md-3">
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h3 class="mb-0">Platforms</h3>
            </div>
            <div class="card-body p-0">
                <table class="table table-striped mb-0">
                    <tbody>
                        {% for platform, nb in platforms_count %}
                            <tr class="text-center">
                                <td>
                                    <img src="{{ asset('img/logos/' ~ platform|lower ~ '.png') }}" alt="{{ platform }}" title="{{ platform }}" width="48" height="48">
                                </td>
                                <td class="fs-5">{{ nb }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    {# Tops Appearance #}
    <div class="col-12 col-md-6">
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h3 class="mb-0">Tops Appearance</h3>
            </div>
            <div class="card-body p-0">
                <table class="table table-striped mb-0">
                    <tbody>
                        {% for top, nb in tops %}
                            <tr class="text-center">
                                <td class="fs-5">Top {{ top }}</td>
                                <td class="fs-5">{{ nb }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{# Cars Used Section #}
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-primary text-white text-center">
                <h2 class="mb-0">Cars Used</h2>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    {% for car_name, nb in cars %}
                        {% set car_image = 'cars/' ~ car_name|car_image ~ '.png' %}
                        <div class="col-6 col-md-2 mb-3">
                            <img src="{{ asset('img/' ~ car_image) }}" alt="{{ car_name }}" title="{{ car_name }}" height="48" class="d-block mx-auto mb-2">
                            <div class="fs-5">{{ nb }}</div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
